<!DOCTYPE html>

<html class="light" lang="en">

<head>
  <meta charset="utf-8" />
  <meta content="width=device-width, initial-scale=1.0" name="viewport" />
  <title>Our Team - ACM NMIET</title>
  <!-- Fonts -->
  <link href="https://fonts.googleapis.com" rel="preconnect" />
  <link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect" />
  <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;700&amp;display=swap"
    rel="stylesheet" />
  <!-- Material Symbols -->
  <link
    href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&amp;display=swap"
    rel="stylesheet" />
  <link
    href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&amp;display=swap"
    rel="stylesheet" />
  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
  <!-- Theme Config -->
  <script>
    tailwind.config = {
      darkMode: "class",
      theme: {
        extend: {
          colors: {
            "primary": "#0a82c2",
            "background-light": "#f5f7f8",
            "background-dark": "#101c22",
          },
          fontFamily: {
            "display": ["Space Grotesk", "sans-serif"]
          },
          borderRadius: { "DEFAULT": "0.25rem", "lg": "0.5rem", "xl": "0.75rem", "full": "9999px" },
        },
      },
    }
  </script>
  <style>
    body {
      font-family: 'Inter', sans-serif;
    }

    .material-symbols-outlined {
      font-variation-settings:
        'FILL' 0,
        'wght' 400,
        'GRAD' 0,
        'opsz' 24
    }
  </style>
</head>

<body class="bg-background-light dark:bg-background-dark text-slate-900 dark:text-white transition-colors duration-200">
  <div class="relative flex h-auto min-h-screen w-full flex-col overflow-x-hidden">
    <!-- Navbar Component (Loaded Dynamically) -->
    <div id="acm-navbar"></div>
    <main class="flex-grow">
      <!-- Hero Section -->
      <section
        class="relative flex flex-col items-center justify-center py-20 px-4 lg:px-40 bg-cover bg-center bg-no-repeat"
        data-alt="Abstract blue geometric pattern background representing technology and connectivity"
        style='background-image: linear-gradient(rgba(15, 28, 35, 0.8), rgba(15, 28, 35, 0.9)), url("https://lh3.googleusercontent.com/aida-public/AB6AXuBiKFJS2Md5p-BRFhUzL-yC-bRV-yMC2Ioh7fE6eH_C5lfwJ1Y_olsK28-3yj0HfZ3DlyZFIAF-rTHc0nG_O4tcJISEA9BNc0TWsmRI4a_1QqqEl3bdjBBaEeqP8ll1ZV6zywEkc4A8uz4jMBoqHCmrA8JsMsasKEppNBoUwPdjAV2TTi-0YOQ8uBMsHchqMsmIlmpUhBA-jjaDVkDPH9-X1WXFc6lnTBZAwOaLsF6Wpf_XePk7FW38hj5jkXE4HWl087g7MacGqpke");'>
        <div class="max-w-[800px] text-center space-y-4 animate-fade-in-up">
          <span
            class="inline-block py-1 px-3 rounded-full bg-primary/20 text-primary text-xs font-bold uppercase tracking-wider border border-primary/20 backdrop-blur-sm">
            Community First
          </span>
          <h1 class="text-white text-4xl md:text-5xl lg:text-6xl font-black leading-tight tracking-[-0.033em]">
            Meet Our Team
          </h1>
          <p class="text-slate-200 text-lg md:text-xl font-normal max-w-2xl mx-auto leading-relaxed">
            The founding members, visionaries, and hard workers building the future of ACM NMIET.
          </p>
        </div>
      </section>
      <!-- Team Sections Container -->
      <div id="team-sections-container">
        <!-- Loading indicator -->
        <section class="py-16 px-4 lg:px-40 bg-background-light dark:bg-background-dark">
          <div class="max-w-[1200px] mx-auto flex justify-center p-10">
            <span class="material-symbols-outlined animate-spin text-4xl text-primary">progress_activity</span>
          </div>
        </section>
      </div>

      <script type="module">
        import { db } from '../assets/js/firebase_config.js';
        import { collection, getDocs, query, orderBy } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        const sectionsContainer = document.getElementById('team-sections-container');

        // Create member card HTML
        function createMemberCard(member) {
          return `
            <div class="group bg-white dark:bg-[#1a2e38] rounded-xl p-6 border border-slate-200 dark:border-slate-700 shadow-sm hover:shadow-xl hover:-translate-y-1 transition-all duration-300 flex flex-col items-center text-center">
              <div class="w-28 h-28 mb-4 relative rounded-full border-2 border-primary/20 group-hover:border-primary transition-colors bg-slate-100">
                <img 
                  src="${member.photoURL || 'https://via.placeholder.com/150'}" 
                  alt="${member.name}"
                  class="absolute inset-0 w-full h-full rounded-full object-cover"
                  onerror="this.onerror=null; this.src='https://via.placeholder.com/150';"
                />
              </div>
              <h3 class="text-lg font-bold text-slate-900 dark:text-white">${member.name}</h3>
              <p class="text-primary font-medium text-sm mb-4">${member.role}</p>
              <div class="flex gap-3 mt-auto">
                ${member.linkedin ? `
                <a href="${member.linkedin}" target="_blank" class="p-2 rounded-full bg-background-light dark:bg-[#1f3642] text-slate-600 dark:text-slate-300 hover:text-primary hover:bg-primary/10 transition-colors">
                  <span class="material-symbols-outlined text-[20px]">link</span>
                </a>` : ''}
                ${member.github ? `
                <a href="${member.github}" target="_blank" class="p-2 rounded-full bg-background-light dark:bg-[#1f3642] text-slate-600 dark:text-slate-300 hover:text-primary hover:bg-primary/10 transition-colors">
                  <span class="material-symbols-outlined text-[20px]">code</span>
                </a>` : ''}
              </div>
            </div>
          `;
        }

        // Create section header HTML
        function createSectionHeader(section) {
          return `
            <div class="text-center mb-12">
              <h2 class="text-slate-900 dark:text-white text-3xl font-bold tracking-tight mb-3 italic">${section.name}</h2>
              <p class="text-slate-600 dark:text-slate-400 text-lg italic max-w-2xl mx-auto">"${section.tagline}"</p>
            </div>
          `;
        }

        // Create full section HTML
        function createSection(section, members, index) {
          const bgClass = index % 2 === 0
            ? 'bg-background-light dark:bg-background-dark'
            : 'bg-white dark:bg-[#13222b]';

          const memberCards = members.map(m => createMemberCard(m)).join('');

          return `
            <section class="py-16 px-4 lg:px-40 ${bgClass}">
              <div class="max-w-[1200px] mx-auto">
                ${createSectionHeader(section)}
                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6">
                  ${memberCards}
                </div>
              </div>
            </section>
          `;
        }

        async function loadTeamWithSections() {
          try {
            // Fetch all sections ordered by 'order' field
            const sectionsQuery = query(collection(db, "team_sections"), orderBy("order", "asc"));
            const sectionsSnapshot = await getDocs(sectionsQuery);

            // Fetch all team members
            const membersQuery = query(collection(db, "team_members"), orderBy("createdAt", "desc"));
            const membersSnapshot = await getDocs(membersQuery);

            // Convert members to array
            const allMembers = [];
            membersSnapshot.forEach(doc => {
              allMembers.push({ id: doc.id, ...doc.data() });
            });

            // If no sections defined, show all members in one section
            if (sectionsSnapshot.empty) {
              sectionsContainer.innerHTML = `
                <section class="py-16 px-4 lg:px-40 bg-background-light dark:bg-background-dark">
                  <div class="max-w-[1200px] mx-auto">
                    <div class="text-center mb-12">
                      <h2 class="text-slate-900 dark:text-white text-3xl font-bold tracking-tight mb-2">Our Team</h2>
                      <div class="h-1 w-20 bg-primary mx-auto rounded-full"></div>
                    </div>
                    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6">
                      ${allMembers.length > 0
                  ? allMembers.map(m => createMemberCard(m)).join('')
                  : '<div class="col-span-full text-center text-slate-500">No team members to show yet.</div>'}
                    </div>
                  </div>
                </section>
              `;
              return;
            }

            // Group members by section based on their role matching section's positions
            let sectionsHTML = '';
            let assignedMembers = new Set();
            let sectionIndex = 0;

            sectionsSnapshot.forEach(doc => {
              const section = doc.data();
              const positions = section.positions || [];

              // Find members whose role matches any position in this section
              const sectionMembers = allMembers.filter(member => {
                const memberRole = (member.role || '').toLowerCase().trim();
                return positions.some(pos => pos.toLowerCase().trim() === memberRole);
              });

              // Track assigned members
              sectionMembers.forEach(m => assignedMembers.add(m.id));

              // Only show section if it has members
              if (sectionMembers.length > 0) {
                sectionsHTML += createSection(section, sectionMembers, sectionIndex);
                sectionIndex++;
              }
            });

            // Find unassigned members (those whose role doesn't match any section)
            const unassignedMembers = allMembers.filter(m => !assignedMembers.has(m.id));

            // Show unassigned members in "Other Members" section if any exist
            if (unassignedMembers.length > 0) {
              const otherSection = {
                name: "Other Members",
                tagline: "Contributing to the success of ACM NMIET"
              };
              sectionsHTML += createSection(otherSection, unassignedMembers, sectionIndex);
            }

            // If no sections had members, show empty state
            if (sectionsHTML === '') {
              sectionsHTML = `
                <section class="py-16 px-4 lg:px-40 bg-background-light dark:bg-background-dark">
                  <div class="max-w-[1200px] mx-auto text-center">
                    <p class="text-slate-500">No team members to show yet.</p>
                  </div>
                </section>
              `;
            }

            sectionsContainer.innerHTML = sectionsHTML;

          } catch (error) {
            console.error("Error loading team:", error);
            sectionsContainer.innerHTML = `
              <section class="py-16 px-4 lg:px-40 bg-background-light dark:bg-background-dark">
                <div class="max-w-[1200px] mx-auto text-center text-red-500">
                  Failed to load team members. Please try again later.
                </div>
              </section>
            `;
          }
        }

        loadTeamWithSections();
      </script>
      <!-- Recruitment CTA -->
      <section class="py-20 px-4 bg-primary text-white">
        <div class="max-w-[800px] mx-auto text-center">
          <span class="material-symbols-outlined text-5xl mb-4 text-white/80">group_add</span>
          <h2 class="text-3xl md:text-4xl font-bold mb-4">Interested in being part of the future?</h2>
          <p class="text-blue-100 text-lg mb-8 max-w-2xl mx-auto">We are always looking for passionate individuals to
            join our community. Whether you are a developer, designer, or just enthusiastic about tech.</p>
          <button
            class="bg-white text-primary hover:bg-slate-100 font-bold py-3 px-8 rounded-lg shadow-lg hover:shadow-xl transition-all transform hover:-translate-y-1 text-lg">
            Get in Touch
          </button>
        </div>
      </section>
    </main>
    <!-- Footer (Simplified) -->
    <!-- Dynamic Footer -->
    <div id="acm-footer"></div>
    <script src="../assets/js/navbar_loader.js"></script>
    <script src="../assets/js/footer_loader.js"></script>
  </div>
</body>

</html>